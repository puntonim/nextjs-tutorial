# NEXT.JS TUTORIAL

Source: https://nextjs.org/learn/basics/create-nextjs-app

Interesting examples:

-   Blog with Markdown and nice UI:
    -   Code: https://github.com/vercel/next.js/tree/canary/examples/blog-starter
    -   Live: https://next-blog-starter.now.sh/
-   Blog with Markdown and Netlify CMS, complete structure but ugly UI:
    -   Code: https://github.com/wutali/nextjs-netlify-blog-template
    -   Live: https://nextjs-netlify-blog-template.netlify.app/
-   With Netlify CMS: https://github.com/vercel/next.js/tree/canary/examples/with-netlify-cms
-   Tutorial at Netlify CMS: https://www.netlifycms.org/docs/nextjs/

## 1. Create the tutorial project

```bash
$ mkdir nextjs-tutorial
$ cd nextjs-tutorial
$ nvm install stable
$ npx create-next-app . --use-npm --example "https://github.com/vercel/next-learn-starter/tree/master/learn-starter"
$ node -v > .nvmrc
```

## 2. Pre-rendering vs NO Pre-rendering

_FOREWORD_: Next.JS is made of a NodeJS part which runs the server app
and a ReactJS part that runs the client app.
Thus when we will talk about Server-side rendering or API routes, we refer
to the NodeJS part.

### NO Pre-rendering (aka Client-side rendering)

In a traditional React app, the server sends the HTML page that includes only JS.
The JS code then makes some API calls and renders the actual HTML content (_hydration_ process).
It requires JS engine, cannot be cached in CDN, CEO does not work, becomes slow when the app grows.
This is NOT the paradigm if Next.js, even tho it is supported, see:

-   [Data Fetching docs](https://nextjs.org/docs/basic-features/data-fetching)
-   [SWR](https://nextjs.org/docs/basic-features/data-fetching#swr)

Eg.: a dashboard is a private, user-specific page, SEO is not relevant, the data is frequently updated.
So it can have a static content (like a skeleton) and then dynamically load other data
with client-side rendering.

### Pre-rendering

Pre-rendering is what used to happen before the Angular/React era.
The server sends HTML pages directly.
When a page is loaded by the browser, its JavaScript code runs and makes the
page fully interactive and brings in additional data (_hydration_ process).
This is the best fitting Next.js paradigm.
These pages work even when the browser does not support JavaScript.
See some diagrams here: https://nextjs.org/learn/basics/data-fetching/pre-rendering

Next.js supports 2 types, depending on WHEN the HTML code is generated:

-   _Static generation, SSG_: it's similar to a classic static page, the HTML is hardcoded (generated
    AT BUILD-TIME, fetching data from APIs if necessary). It's also distributed to the CDN at deploy time.
    The page is pre-render ahead of a user's request.
    Eg.: Blog posts, e-commerce product listings, help pages.
-   _Server-side rendering, SSR, aka Dynamic rendering_: the HTML is generated by the server part (NodeJS)
    on each request, so it can NOT be cached (no CDN).
    When deployed on Vercel, each Server-side rendered page is automatically mapped to a Serverless (NodeJS) function.

See more here: https://nextjs.org/learn/basics/data-fetching/two-forms

## 3. Methods for NO/Pre-rendering

### NO Pre-rendering (aka Client-side rendering)

Use SWR, very cool: [SWR](https://nextjs.org/docs/basic-features/data-fetching#swr)

### Pre-rendering with Static generation:

Use [`getStaticProps`](https://nextjs.org/docs/basic-features/data-fetching#getstaticprops-static-generation)
to fetch data AT BUILD-TIME.
Use [`getStaticPaths`](https://nextjs.org/docs/basic-features/data-fetching#getstaticpaths-static-generation)
to create parametric paths (slugs) AT BUILD-TIME.

These methods are executed at build time and they are not even included in the
client JS bundle for the browser.

### Pre-rendering with Server-side rendering:

Use [getServerSideProps](https://nextjs.org/docs/basic-features/data-fetching#getserversideprops-server-side-rendering)
to fetch data ON EVERY request.

This method is EXECUTED SERVER-SIDE by NodeJS: it can connect to the DB or call external APIs.
This method is not even included in the client JS bundle for the browser.

## 4. API routes

Next.JS has a server part in NodeJS.
The server part con include API endpoints, like a regular Express project.
See more: https://nextjs.org/docs/api-routes/introduction
